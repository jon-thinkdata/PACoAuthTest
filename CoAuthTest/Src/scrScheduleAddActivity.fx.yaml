scrScheduleAddActivity As screen:
    OnVisible: |-
        =UpdateContext({ResetNewProject:true});UpdateContext({ResetNewProject:false})

    Icon3_2 As icon.Add:
        Height: =56
        Icon: =Icon.Add
        OnSelect: =Set(ResetNewActivity,true);Set(ResetNewActivity,false);Navigate(scrScheduleNewActivity)
        Width: =56
        X: =316
        Y: =282
        ZIndex: =1

    txtArea_2 As text:
        Default: =LookUp('[dbo].[tblTrades]',TradeID = cboxActivityNum.Selected.TradeID,Trade)
        DisplayMode: =DisplayMode.View
        Height: =56
        HintText: |-
            ="Choose an activity #"
        PaddingBottom: =3.75
        PaddingLeft: =9.00
        Reset: =ResetNewProject
        Size: =17.99
        Width: =325
        X: =37
        Y: =537
        ZIndex: =2

    lblNewProject_4 As label:
        Align: =Align.Center
        Height: =56.22
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =26.99
        Text: =Concatenate(LookUp('[dbo].[tblProjects]',ProjectID=SelectedProjectID,ProjectNum),Concatenate(" ",LookUp('[dbo].[tblProjects]',ProjectID=SelectedProjectID,ProjectName)))
        Width: =Parent.Width
        Y: =100
        ZIndex: =3

    lblNewProject_2 As label:
        Align: =Align.Center
        Height: =56.22
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =26.99
        Text: ="Add an activity to the Schedule"
        Width: =Parent.Width
        Y: =153.60
        ZIndex: =8

    btnSubmit_1 As button:
        Fill: =RGBA(168, 0, 0, 1)
        Height: =49.48
        OnSelect: |-
            =UpdateContext({ActivityCheckPopup:true})
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =14.99
        Text: ="Submit"
        Width: =264
        X: =(Parent.Width-btnSubmit_1.Width)/2
        Y: =899.56
        ZIndex: =9

    lblActivityNum As label:
        Height: =37
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =17.99
        Text: |-
            ="Activity #"
        Width: =293
        X: =38
        Y: =247.30
        ZIndex: =10

    grpBanner_4 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =10

        recBanner_4 As rectangle:
            Height: =85.33
            Width: =768
            Y: =0.00
            ZIndex: =4

        imgClientLogo_4 As image:
            Height: =77.84
            Image: =ComfortSystemsLogo
            ImagePosition: =ImagePosition.Fill
            PaddingBottom: =0.00
            PaddingLeft: =0.00
            Width: =imgClientLogo_4.Height*2
            X: =recBanner_4.X+5
            Y: =3.75
            ZIndex: =5

        "'lblToday''sDate_4' As label":
            Align: =Align.Right
            Color: =RGBA(255, 255, 255, 1)
            Height: =28.44
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =13.49
            Text: =Today()
            Width: =Parent.Width/2
            X: =(recBanner_4.X+recBanner_4.Width)-'lblToday''sDate_4'.Width
            Y: =0.00
            ZIndex: =6

        lblWelcome_4 As label:
            Align: =Align.Right
            Color: =RGBA(255, 255, 255, 1)
            Height: =28.44
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =13.49
            Text: =Concatenate("Welcome  ",User().FullName)
            Width: =Parent.Width/2
            X: =(recBanner_4.X+recBanner_4.Width)-lblWelcome_4.Width
            Y: =56.89
            ZIndex: =7

    icoBack_3 As icon.BackArrow:
        Height: =47.98
        Icon: =Icon.BackArrow
        OnSelect: |-
            =UpdateContext({ResetAddActivity:true});UpdateContext({ResetAddActivity:false});Navigate(scrScheduleProjectActivities,ScreenTransition.UnCoverRight)
        PaddingBottom: =0.00
        PaddingLeft: =0.00
        X: =20
        Y: =100.33
        ZIndex: =11

    lblActivityDesc As label:
        Height: =37.48
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =17.99
        Text: ="Activity Description"
        Width: =Parent.Width/2
        X: =(Parent.Width-lblActivityDesc.Width)/10
        Y: =359.75
        ZIndex: =12

    txtActivityDesc As text:
        Default: =LookUp('[dbo].[tblActivities]',ActivityID=First(cboxActivityNum.SelectedItems.ActivityID).ActivityID,ActivityDesc)
        DisplayMode: =DisplayMode.View
        Height: =56.22
        HintText: |-
            ="Choose an activity #"
        PaddingBottom: =3.75
        PaddingLeft: =9.00
        Reset: =ResetNewProject
        Size: =17.99
        Width: =Parent.Width*.9
        X: =lblActivityDesc.X
        Y: =397.23
        ZIndex: =13

    lblTrade As label:
        Height: =38
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =17.99
        Text: ="Trade"
        Width: =328
        X: =38
        Y: =499
        ZIndex: =14

    lblNumOfMen As label:
        Height: =37
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =17.99
        Text: |-
            ="# of Men"
        Width: =326
        X: =403
        Y: =500
        ZIndex: =15

    lblGoal As label:
        Height: =36
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =17.99
        Text: ="Goal"
        Width: =327
        X: =38
        Y: =769
        ZIndex: =16

    lblArea As label:
        Height: =37
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =17.99
        Text: ="Area"
        Width: =293
        X: =404
        Y: =247
        ZIndex: =17

    txtArea As text:
        Default: =LookUp('[dbo].[tblActivities]',ActivityID=First(cboxActivityNum.SelectedItems.ActivityID).ActivityID,Area)
        DisplayMode: =DisplayMode.View
        Height: =56
        HintText: |-
            ="Choose an activity #"
        PaddingBottom: =3.75
        PaddingLeft: =9.00
        Reset: =ResetNewProject
        Size: =17.99
        Width: =325
        X: =404
        Y: =284
        ZIndex: =18

    lblStartDate As label:
        Height: =37
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =17.99
        Text: |-
            ="Start Date
            "
        Width: =346
        X: =38
        Y: =645
        ZIndex: =19

    DatePickerStartDate As datepicker:
        DefaultDate: =
        Height: =56.22
        InputTextPlaceholder: =
        Reset: =ResetAddActivity
        Width: =325
        X: =38
        Y: =682
        ZIndex: =20

    lblDuration As label:
        Height: =37
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =17.99
        Text: ="Duration (Days)"
        Width: =326
        X: =403
        Y: =645
        ZIndex: =21

    cboxActivityNum As combobox:
        DisplayFields: =["ActivityNum"]
        Height: =57
        IsSearchable: =false
        Items: ='[dbo].[tblActivities]'
        Reset: =ResetAddActivity
        SearchFields: =["ActivityNum"]
        SearchItems: =[]
        SelectMultiple: =false
        Width: =275
        X: =38
        Y: =283
        ZIndex: =22

    txtNumOfMen As text:
        Default: =
        Format: =TextFormat.Number
        Height: =56
        HintText: ="Enter a number"
        PaddingBottom: =3.75
        PaddingLeft: =9.00
        Reset: =ResetAddActivity
        Size: =17.99
        Width: =325
        X: =404
        Y: =537
        ZIndex: =23

    sliderDuration As slider:
        Default: =7
        Height: =56
        Max: =35
        Reset: =ResetAddActivity
        X: =403
        Y: =682
        ZIndex: =24

    txtGoal As text:
        Default: =
        Format: =TextFormat.Number
        Height: =56
        HintText: ="Enter a number"
        PaddingBottom: =3.75
        PaddingLeft: =9.00
        Reset: =ResetAddActivity
        Size: =17.99
        Width: =329
        X: =37
        Y: =805
        ZIndex: =25

    cboxUnit As combobox:
        DisplayFields: =["Unit"]
        Height: =56
        IsSearchable: =false
        Items: ='[dbo].[tblUnits]'
        Reset: =ResetAddActivity
        SearchFields: =["Unit"]
        SearchItems: =[]
        SelectMultiple: =false
        Width: =275
        X: =404
        Y: =806
        ZIndex: =26

    lblUnit As label:
        Height: =36
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =17.99
        Text: ="Unit"
        Width: =327
        X: =404
        Y: =769
        ZIndex: =27

    Icon3_1 As icon.Add:
        Height: =56
        Icon: =Icon.Add
        OnSelect: |-
            =UpdateContext({ResetAddUnit:true});UpdateContext({ResetAddUnit:false});UpdateContext({AddUnit:true})
        Width: =56
        X: =679
        Y: =806
        ZIndex: =28

    grpAddActivityCheckPopup As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =56

        Rectangle3 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =939
            Visible: =ActivityCheckPopup
            Width: =768
            Y: =85
            ZIndex: =29

        lblActivityNum_1 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: |-
                ="Activity #"
            Visible: =ActivityCheckPopup
            Width: =225
            X: =20
            Y: =233
            ZIndex: =30

        lblArea_1 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: ="Area"
            Visible: =ActivityCheckPopup
            Width: =225
            X: =20
            Y: =275
            ZIndex: =31

        lvlActivityDesc_1 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: |-
                ="Activity Description
                "
            Visible: =ActivityCheckPopup
            Width: =225
            X: =20
            Y: =317
            ZIndex: =32

        lblTrade_1 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: ="Trade"
            Visible: =ActivityCheckPopup
            Width: =225
            X: =20
            Y: =359
            ZIndex: =33

        lblNewProject_3 As label:
            Align: =Align.Center
            Height: =100
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =26.99
            Text: ="Please ensure the following information is correct."
            Visible: =ActivityCheckPopup
            Width: =Parent.Width
            Y: =114
            ZIndex: =34

        btnConfirm_1 As button:
            Fill: =RGBA(168, 0, 0, 1)
            Height: =49.48
            OnSelect: |-
                =Patch(
                    '[dbo].[tblSchedule]',
                    Defaults('[dbo].[tblSchedule]'),
                    {
                        ProjectID: SelectedProjectID,
                        ActivityID: cboxActivityNum.Selected.ActivityID,
                        StatusID: 4, //4=Not Started
                        NumOfMen: Value(txtNumOfMen.Text),
                        StartDate: DatePickerStartDate.SelectedDate,
                        Duration: sliderDuration.Value,
                        Goal: Value(txtGoal.Text),
                        UnitID: cboxUnit.Selected.UnitID,
                        Created: Today(),
                        CreatedBy: User().Email
                    }
                );
                UpdateContext({ActivityCheckPopup:false});
                UpdateContext({ResetAddActivity:true});
                UpdateContext({ResetAddActivity:false});
                Navigate(scrScheduleProjectActivities)
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =14.99
            Text: ="Confirm"
            Visible: =ActivityCheckPopup
            Width: =264
            X: =444
            Y: =905
            ZIndex: =35

        btnCancel_1 As button:
            Fill: =RGBA(168, 0, 0, 1)
            Height: =49.48
            OnSelect: |-
                =UpdateContext({ActivityCheckPopup:false})
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =14.99
            Text: ="Cancel"
            Visible: =ActivityCheckPopup
            Width: =264
            X: =68
            Y: =904
            ZIndex: =36

        lblNumOfMen_1 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: |-
                ="# of Men"
            Visible: =ActivityCheckPopup
            Width: =225
            X: =20
            Y: =401
            ZIndex: =37

        lblStartDate_1 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: ="Start Date"
            Visible: =ActivityCheckPopup
            Width: =225
            X: =20
            Y: =443
            ZIndex: =38

        lblEndDate As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: ="End Date"
            Visible: =ActivityCheckPopup
            Width: =225
            X: =20
            Y: =485
            ZIndex: =39

        lblDuration_1 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: ="Duration"
            Visible: =ActivityCheckPopup
            Width: =225
            X: =20
            Y: =527
            ZIndex: =40

        lblManHours As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: ="Man Hours"
            Visible: =ActivityCheckPopup
            Width: =225
            X: =20
            Y: =569
            ZIndex: =41

        lblGoal_1 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: ="Goal"
            Visible: =ActivityCheckPopup
            Width: =225
            X: =20
            Y: =611
            ZIndex: =42

        lblActivityNum_2 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =First(cboxActivityNum.SelectedItems.ActivityNum).ActivityNum
            Visible: =ActivityCheckPopup
            Width: =475
            X: =275
            Y: =233
            ZIndex: =43

        lblArea_2 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =LookUp('[dbo].[tblActivities]',ActivityID=First(cboxActivityNum.SelectedItems.ActivityID).ActivityID,Area)
            Visible: =ActivityCheckPopup
            Width: =475
            X: =275
            Y: =275
            ZIndex: =44

        lvlActivityDesc_2 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =LookUp('[dbo].[tblActivities]',ActivityID=First(cboxActivityNum.SelectedItems.ActivityID).ActivityID,ActivityDesc)
            Visible: =ActivityCheckPopup
            Width: =475
            X: =275
            Y: =317
            ZIndex: =45

        lblTrade_2 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =LookUp('[dbo].[tblTrades]',TradeID = cboxActivityNum.Selected.TradeID,Trade)
            Visible: =ActivityCheckPopup
            Width: =475
            X: =275
            Y: =359
            ZIndex: =46

        lblNumOfMen_2 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =txtNumOfMen.Text
            Visible: =ActivityCheckPopup
            Width: =475
            X: =275
            Y: =401
            ZIndex: =47

        lblStartDate_2 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =DatePickerStartDate.SelectedDate
            Visible: =ActivityCheckPopup
            Width: =475
            X: =275
            Y: =443
            ZIndex: =48

        lblEndDate_1 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =DateAdd(DatePickerStartDate.SelectedDate,sliderDuration.Value)
            Visible: =ActivityCheckPopup
            Width: =475
            X: =275
            Y: =485
            ZIndex: =49

        lblDuration_2 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =sliderDuration.Value
            Visible: =ActivityCheckPopup
            Width: =475
            X: =275
            Y: =527
            ZIndex: =50

        lblManHours_1 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =sliderDuration.Value*8
            Visible: =ActivityCheckPopup
            Width: =475
            X: =275
            Y: =569
            ZIndex: =51

        lblGoal_2 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =Concatenate(txtGoal.Text,Concatenate(" ",First(cboxUnit.SelectedItems.Unit).Unit))
            Visible: =ActivityCheckPopup
            Width: =475
            X: =275
            Y: =611
            ZIndex: =52

    grpAddUnit As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =67

        Rectangle4_1 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =940
            Visible: =AddUnit
            Width: =768
            Y: =84
            ZIndex: =53

        btnConfirm_3 As button:
            Fill: =RGBA(168, 0, 0, 1)
            Height: =49.48
            OnSelect: |-
                =Patch(
                    '[dbo].[tblUnits]',
                    Defaults('[dbo].[tblUnits]'),
                    {
                        Unit: txtNewUnit.Text
                    }
                );
                UpdateContext({AddUnit:false});
                UpdateContext({ResetAddUnit:true});
                UpdateContext({ResetAddUnit:false})
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =14.99
            Text: ="Add"
            Visible: =AddUnit
            Width: =264
            X: =464
            Y: =925
            ZIndex: =54

        btnCancel_3 As button:
            Fill: =RGBA(168, 0, 0, 1)
            Height: =49.48
            OnSelect: |-
                =UpdateContext({ResetAddUnit:true});UpdateContext({ResetAddUnit:false});UpdateContext({AddUnit:false})
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =14.99
            Text: ="Cancel"
            Visible: =AddUnit
            Width: =264
            X: =88
            Y: =924
            ZIndex: =55

        lblNewUnit As label:
            Size: =18
            Text: |-
                ="New Unit:"
            Visible: =AddUnit
            X: =57
            Y: =226
            ZIndex: =56

        txtNewUnit As text:
            Default: =
            HintText: ="Enter a new Unit"
            Reset: =ResetAddUnit
            Size: =18
            Visible: =AddUnit
            Width: =450
            X: =207
            Y: =226
            ZIndex: =57

        lblExistingUnits As label:
            Size: =18
            Text: |-
                ="Existing Units:"
            Visible: =AddUnit
            Width: =250
            X: =37
            Y: =322
            ZIndex: =58

        galExistingUnits As gallery.galleryVertical:
            BorderThickness: =2
            Height: =500
            Items: ='[dbo].[tblUnits]'
            Layout: =Layout.Vertical
            TemplateSize: =80
            Visible: =AddUnit
            Width: =694
            X: =37
            Y: =362
            ZIndex: =59

            Label9_1 As label:
                OnSelect: =Select(Parent)
                Size: =18
                Text: =ThisItem.Unit
                X: =20
                Y: =20
                ZIndex: =1

            Rectangle5_1 As rectangle:
                Height: =1
                OnSelect: =Select(Parent)
                Width: =684
                Y: =79
                ZIndex: =2

