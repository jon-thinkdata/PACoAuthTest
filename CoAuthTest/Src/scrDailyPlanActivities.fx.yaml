scrDailyPlanActivities As screen:
    OnVisible: |-
        =Set(varGlobalTime,Text(Now(),ShortDateTime));
        
        Set(varActivityScheduleDetails, Blank());
        Set(varActivityNum, Blank());
        Set(varActivityDesc, Blank());
        Set(varActivityStatus, Blank());
        Set(varActivityTotalMetricsQTY, Blank());
        Set(varActivityMeasure, Blank());
        Set(varActivityBaseNumMen, Blank());
            Set(varActivityUpdatedBaseNumMen,Blank());
        Set(varActivityTrade, Blank());
        Set(varActivityCostCode, Blank());
        Set(varActivityPlanStartDate, Blank());
        Set(varActivityPlanEndDate, Blank());
        Set(varActivityProductionPerDay, Blank());
        Set(varActivityDuration, Blank());
        Set(varActivityTotalManHours, Blank());
        Set(varActivityTarget, Blank());
        Set(varActivityFinalized, Blank());
        Set(varActivityArea, Blank());
        
        Set(varActivityRemainingQTY, Blank());
        Set(varActivityRemainingHours, Blank());
        Set(varActivityRemainingScheduleDays,Blank());
        Set(varActivityRemainingScheduleHours,Blank());
        Set(varActivityDailyGoal, Blank());
        
        Set(varActivityActualHours,Blank());
        Set(varActivityEstHoursToDate,Blank());
        Set(varActivityEstQTYToDate,Blank());

    dbug_FilteredDailyActivities As dataTable.datatable:
        BorderStyle: =BorderStyle.Solid
        DisplayMode: =DisplayMode.Edit
        Fill: =RGBA(255, 255, 255, 1)
        Height: =186
        Items: |-
            =Filter(
                        tblDailyActivities,
                        ProjectInternalID = "1794-H" && ActivityAutoID = 62
                    )
        Visible: =false
        Width: =768
        X: =0
        Y: =837
        ZIndex: =1

        Title_Column2 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Title"
            FieldName: ="Title"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =1
            Text: =ThisItem.Title
            Width: =100
            X: =0
            Y: =0
            ZIndex: =10

        ProjectInternalID_Column1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="ProjectInternalID"
            FieldName: ="ProjectInternalID"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =2
            Text: =ThisItem.ProjectInternalID
            Width: =100
            X: =0
            Y: =0
            ZIndex: =11

        ActivityAutoID_Column1 As dataTableColumn.numberColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="ActivityAutoID"
            FieldName: ="ActivityAutoID"
            FieldVariantName: ="numberColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =3
            Text: =ThisItem.ActivityAutoID
            Width: =100
            X: =0
            Y: =0
            ZIndex: =12

        ActivityDate_Column1 As dataTableColumn.dateTimeColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="ActivityDate"
            FieldName: ="ActivityDate"
            FieldVariantName: ="dateTimeColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =4
            Text: =Text(ThisItem.ActivityDate,DateTimeFormat.LongDateTime)
            Width: =100
            X: =0
            Y: =0
            ZIndex: =13

        ActivityNum_Column1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="ActivityNum"
            FieldName: ="ActivityNum"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =5
            Text: =ThisItem.ActivityNum
            Width: =100
            X: =0
            Y: =0
            ZIndex: =14

        ActivityDescription_Column1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="ActivityDescription"
            FieldName: ="ActivityDescription"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =6
            Text: =ThisItem.ActivityDescription
            Width: =100
            X: =0
            Y: =0
            ZIndex: =15

        ActivityCostCode_Column1 As dataTableColumn.numberColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="ActivityCostCode"
            FieldName: ="ActivityCostCode"
            FieldVariantName: ="numberColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =7
            Text: =ThisItem.ActivityCostCode
            Width: =100
            X: =0
            Y: =0
            ZIndex: =16

        Trade_Column1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Trade"
            FieldName: ="Trade"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =8
            Text: =ThisItem.Trade
            Width: =100
            X: =0
            Y: =0
            ZIndex: =17

        TotalMetricsQTY_Column1 As dataTableColumn.numberColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="TotalMetricsQTY"
            FieldName: ="TotalMetricsQTY"
            FieldVariantName: ="numberColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =9
            Text: =ThisItem.TotalMetricsQTY
            Width: =100
            X: =0
            Y: =0
            ZIndex: =18

        Measure_Column1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Measure"
            FieldName: ="Measure"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =10
            Text: =ThisItem.Measure
            Width: =100
            X: =0
            Y: =0
            ZIndex: =19

        BaseNumMen_Column1 As dataTableColumn.numberColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="BaseNumMen"
            FieldName: ="BaseNumMen"
            FieldVariantName: ="numberColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =11
            Text: =ThisItem.BaseNumMen
            Width: =100
            X: =0
            Y: =0
            ZIndex: =20

        PlanStartDate_Column1 As dataTableColumn.dateTimeColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="PlanStartDate"
            FieldName: ="PlanStartDate"
            FieldVariantName: ="dateTimeColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =12
            Text: =Text(ThisItem.PlanStartDate,DateTimeFormat.LongDateTime)
            Width: =100
            X: =0
            Y: =0
            ZIndex: =21

        PlanEndDate_Column1 As dataTableColumn.dateTimeColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="PlanEndDate"
            FieldName: ="PlanEndDate"
            FieldVariantName: ="dateTimeColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =13
            Text: =Text(ThisItem.PlanEndDate,DateTimeFormat.LongDateTime)
            Width: =100
            X: =0
            Y: =0
            ZIndex: =22

        ProductionPerDay_Column1 As dataTableColumn.numberColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="ProductionPerDay"
            FieldName: ="ProductionPerDay"
            FieldVariantName: ="numberColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =14
            Text: =ThisItem.ProductionPerDay
            Width: =100
            X: =0
            Y: =0
            ZIndex: =23

        ActivityDuration_Column1 As dataTableColumn.numberColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="ActivityDuration"
            FieldName: ="ActivityDuration"
            FieldVariantName: ="numberColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =15
            Text: =ThisItem.ActivityDuration
            Width: =100
            X: =0
            Y: =0
            ZIndex: =24

        TotalManHours_Column1 As dataTableColumn.numberColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="TotalManHours"
            FieldName: ="TotalManHours"
            FieldVariantName: ="numberColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =16
            Text: =ThisItem.TotalManHours
            Width: =100
            X: =0
            Y: =0
            ZIndex: =25

        Target_Column1 As dataTableColumn.numberColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Target"
            FieldName: ="Target"
            FieldVariantName: ="numberColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =17
            Text: =ThisItem.Target
            Width: =100
            X: =0
            Y: =0
            ZIndex: =26

        Finalized_Column1 As dataTableColumn.booleanColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Finalized"
            FieldName: ="Finalized"
            FieldVariantName: ="booleanColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =18
            Text: =ThisItem.Finalized
            Width: =100
            X: =0
            Y: =0
            ZIndex: =27

        Area_Column1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Area"
            FieldName: ="Area"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =19
            Text: =ThisItem.Area
            Width: =100
            X: =0
            Y: =0
            ZIndex: =28

        WorkingToday_Column1 As dataTableColumn.booleanColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="WorkingToday"
            FieldName: ="WorkingToday"
            FieldVariantName: ="booleanColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =20
            Text: =ThisItem.WorkingToday
            Width: =100
            X: =0
            Y: =0
            ZIndex: =29

        HowManyWorkers_Column1 As dataTableColumn.numberColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="HowManyWorkers"
            FieldName: ="HowManyWorkers"
            FieldVariantName: ="numberColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =21
            Text: =ThisItem.HowManyWorkers
            Width: =100
            X: =0
            Y: =0
            ZIndex: =30

        GoalGood_Column1 As dataTableColumn.booleanColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="GoalGood"
            FieldName: ="GoalGood"
            FieldVariantName: ="booleanColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =22
            Text: =ThisItem.GoalGood
            Width: =100
            X: =0
            Y: =0
            ZIndex: =31

        ChangeGoal_Column1 As dataTableColumn.booleanColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="ChangeGoal"
            FieldName: ="ChangeGoal"
            FieldVariantName: ="booleanColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =23
            Text: =ThisItem.ChangeGoal
            Width: =100
            X: =0
            Y: =0
            ZIndex: =32

        NewDailyGoal_Column1 As dataTableColumn.numberColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="NewDailyGoal"
            FieldName: ="NewDailyGoal"
            FieldVariantName: ="numberColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =24
            Text: =ThisItem.NewDailyGoal
            Width: =100
            X: =0
            Y: =0
            ZIndex: =33

        Issue_Column1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Issue"
            FieldName: ="Issue"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =25
            Text: =ThisItem.Issue
            Width: =100
            X: =0
            Y: =0
            ZIndex: =34

        IssueNotes_Column1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="IssueNotes"
            FieldName: ="IssueNotes"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =26
            Text: =ThisItem.IssueNotes
            Width: =100
            X: =0
            Y: =0
            ZIndex: =35

        EndDay_WorkersUsed_Column1 As dataTableColumn.numberColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="EndDay_WorkersUsed"
            FieldName: ="EndDay_WorkersUsed"
            FieldVariantName: ="numberColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =27
            Text: =ThisItem.EndDay_WorkersUsed
            Width: =100
            X: =0
            Y: =0
            ZIndex: =36

        EndDay_HoursWork_Column1 As dataTableColumn.numberColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="EndDay_HoursWork"
            FieldName: ="EndDay_HoursWork"
            FieldVariantName: ="numberColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =28
            Text: =ThisItem.EndDay_HoursWork
            Width: =100
            X: =0
            Y: =0
            ZIndex: =37

        EndDay_AmtComplete_Column1 As dataTableColumn.numberColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="EndDay_AmtComplete"
            FieldName: ="EndDay_AmtComplete"
            FieldVariantName: ="numberColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =29
            Text: =ThisItem.EndDay_AmtComplete
            Width: =100
            X: =0
            Y: =0
            ZIndex: =38

        GoalMet_Column1 As dataTableColumn.booleanColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="GoalMet"
            FieldName: ="GoalMet"
            FieldVariantName: ="booleanColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =30
            Text: =ThisItem.GoalMet
            Width: =100
            X: =0
            Y: =0
            ZIndex: =39

        GoalNotMetIssue_Column1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="GoalNotMetIssue"
            FieldName: ="GoalNotMetIssue"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =31
            Text: =ThisItem.GoalNotMetIssue
            Width: =100
            X: =0
            Y: =0
            ZIndex: =40

        GoalNotMetIssue_Notes_Column1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="GoalNotMetIssue_Notes"
            FieldName: ="GoalNotMetIssue_Notes"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =32
            Text: =ThisItem.GoalNotMetIssue_Notes
            Width: =100
            X: =0
            Y: =0
            ZIndex: =41

        GoalExceeded_Column1 As dataTableColumn.booleanColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="GoalExceeded"
            FieldName: ="GoalExceeded"
            FieldVariantName: ="booleanColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =33
            Text: =ThisItem.GoalExceeded
            Width: =100
            X: =0
            Y: =0
            ZIndex: =42

        ActualStartDate_Column1 As dataTableColumn.dateTimeColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="ActualStartDate"
            FieldName: ="ActualStartDate"
            FieldVariantName: ="dateTimeColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =34
            Text: =Text(ThisItem.ActualStartDate,DateTimeFormat.LongDateTime)
            Width: =100
            X: =0
            Y: =0
            ZIndex: =43

        ActualEndDate_Column1 As dataTableColumn.dateTimeColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="ActualEndDate"
            FieldName: ="ActualEndDate"
            FieldVariantName: ="dateTimeColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =35
            Text: =Text(ThisItem.ActualEndDate,DateTimeFormat.LongDateTime)
            Width: =100
            X: =0
            Y: =0
            ZIndex: =44

        _OldID_Column1 As dataTableColumn.numberColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="_OldID"
            FieldName: ="OData__OldID"
            FieldVariantName: ="numberColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =36
            Text: =ThisItem._OldID
            Width: =100
            X: =0
            Y: =0
            ZIndex: =45

    del_lblDailyPlanActivitiesScheduleManHoursFIX_3 As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Normal
        Height: =85
        OnSelect: =Select(Parent)
        PaddingBottom: =0
        PaddingRight: =0
        PaddingTop: =0
        Size: =13
        Text: |-
            =Sum(
                Filter(
                    tblActivities,
                    ProjectInternalID = varSelectedDailyPlanProjectInternalID
                ),
                TotalManHours
            ) & 
            " Total Estimated" &
            Char(13) &
            "__" &
            " As of Today" &
            Char(13) &
            "__" &
            " Actual Used" &
            Char(13) &
            Sum(
                Filter(
                    tblActivities,
                    ProjectInternalID = varSelectedDailyPlanProjectInternalID
                ),
                TotalManHours
            ) - Sum(
                Filter(
                    tblDailyActivities,
                    ProjectInternalID = varSelectedDailyPlanProjectInternalID
                ),
                EndDay_HoursWork
            ) &
            " Remaining"
            
            //Old Formula
            /*Sum(
                Filter(
                    tblActivities,
                    ProjectInternalID = varSelectedDailyPlanProjectInternalID
                ),
                TotalManHours
            ) - Sum(
                Filter(
                    tblDailyActivities,
                    ProjectInternalID = varSelectedDailyPlanProjectInternalID
                ),
                EndDay_HoursWork
            ) & 
            " Total Remaining Hours/ " & 
            Sum(
                Filter(
                    tblActivities,
                    ProjectInternalID = varSelectedDailyPlanProjectInternalID
                ),
                TotalManHours
            ) & 
            " Total Estimated Hours"*/
        Visible: =false
        Width: =369
        X: =191
        Y: =195
        ZIndex: =2

    lblDailyPlanActivitiesSearchNavLabel As label:
        Align: =Align.Center
        Height: =81
        Size: =16
        Text: ="Would you like to add any other activities today?"
        Width: =530
        X: =127
        Y: =875
        ZIndex: =3

    lblDailyPlanActivitiesStartingTodayManHours As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Semibold
        Size: =15
        Text: ="Man Hours"
        VerticalAlign: =VerticalAlign.Bottom
        Width: =120
        X: =580
        Y: =635
        ZIndex: =4

    btnDailyPlanActivitiesSearchNav As button:
        DisplayMode: =Edit
        Fill: =RGBA(168, 0, 0, 1)
        Height: =49.48
        HoverFill: =ColorFade(RGBA(168, 0, 0, 1), -20%)
        OnSelect: =Navigate(scrActivitiesSearch)
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =14.99
        Text: ="Search"
        Width: =200
        X: =292
        Y: =956
        ZIndex: =5

    recDailyPlanActivitiesStartingTodayCCSeparator As rectangle:
        Fill: =RGBA(166, 166, 166, 1)
        Height: =lblDailyPlanActivitiesStartingTodayCC.Height + galDailyPlanActivitiesSchedule.Height
        OnSelect: =
        Width: =1
        X: =lblDailyPlanActivitiesStartingTodayCC.X+lblDailyPlanActivitiesStartingTodayCC.Width
        Y: =lblDailyPlanActivitiesStartingTodayCC.Y
        ZIndex: =6

    lblDailyPlanActivitiesStartingTodayCC As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Semibold
        Size: =15
        Text: ="Cost Code"
        VerticalAlign: =VerticalAlign.Bottom
        Width: =110
        X: =450
        Y: =635
        ZIndex: =7

    "galDailyPlanActivitiesStartingToday As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
        BorderColor: =RGBA(166, 166, 166, 1)
        BorderThickness: =2
        Height: =200
        Items: |-
            =Filter(
                AddColumns(
                    tblActivities,
                    "StartingToday",
                    If( //Checking Today against the Start and End dates of all scheduled activities
                        Today() = DateValue(Text(PlanStartDate)),
                        true, 
                        false
                    )
                ),
                ProjectInternalID = varSelectedDailyPlanProjectInternalID, //Filter to the selected Project
                Not( //Filtering out any Activity that was started today
                    ActivityAutoID in Filter(
                        colFilteredDailyActivities,
                        Today() = DateValue(Text(ActivityDate))
                    ).ActivityAutoID
                ),
                StartingToday = true,
                Finalized <> true
            )
        Layout: =Layout.Vertical
        OnSelect: |-
            =UpdateContext({varActivityLoadingVis:true});
            Set(varActivityScheduleDetails, ThisItem);
            Set(varActivityNum, ThisItem.ActivityNum);
            Set(varActivityDesc, ThisItem.ActivityDescription);
            Set(varActivityStatus, 4); //This needs to be updated. 4 is a placeholder for 'Not Started'
            Set(varActivityTotalMetricsQTY, ThisItem.TotalMetricsQTY);
            Set(varActivityMeasure, ThisItem.Measure);
            Set(varActivityBaseNumMen, ThisItem.BaseNumMen);
            Set(varActivityUpdatedBaseNumMen, Blank());
            Set(varActivityTrade, ThisItem.Trade);
            Set(varActivityCostCode, ThisItem.ActivityCostCode);
            Set(varActivityPlanStartDate, ThisItem.PlanStartDate);
            Set(varActivityPlanEndDate, ThisItem.PlanEndDate);
            Set(varActivityProductionPerDay, ThisItem.ProductionPerDay);
            Set(varActivityDuration, ThisItem.ActivityDuration);
            Set(varActivityTotalManHours, ThisItem.TotalManHours);
            Set(varActivityTarget, ThisItem.Target);
            Set(varActivityFinalized, ThisItem.Finalized);
            Set(varActivityArea, ThisItem.Area);
            Clear(colCountDailyActivities);
            ForAll(
                Filter(
                    tblDailyActivities,
                    ProjectInternalID = ThisItem.ProjectInternalID && ActivityAutoID = ThisItem.ActivityAutoID
                ),
                Collect(
                    colCountDailyActivities,
                    {
                        Value: 1
                    }
                )
            );
            Set(
                varActivityRemainingQTY,
            	RoundUp(
                    ThisItem.TotalMetricsQTY - Sum(
                        Filter(
                            tblDailyActivities,
                            ProjectInternalID = ThisItem.ProjectInternalID && ActivityAutoID = ThisItem.ActivityAutoID
                        ),
                        EndDay_AmtComplete
                    ),
                    2
                )
            );
            Set(
                varActivityRemainingHours,
                varActivityScheduleDetails.TotalManHours - Sum(
                    Filter(
                        tblDailyActivities,
                        ProjectInternalID = ThisItem.ProjectInternalID && ActivityAutoID = ThisItem.ActivityAutoID
                    ),
                    EndDay_HoursWork
                )
            );
            Set(
                varActivityRemainingScheduleDays,
                RoundDown((DateDiff(DateValue(Today()),DateValue(ThisItem.PlanEndDate),Days)) /7, 0) * 5 + Mod(5 + Weekday(DateValue(ThisItem.PlanEndDate)) - Weekday(Today()), 5) - CountIf(tblHolidays,Date >= Today(), Date <= ThisItem.PlanEndDate) +1
            );
            Set(
                varActivityRemainingScheduleHours,
                varActivityRemainingScheduleDays * varActivityBaseNumMen * 8
            );
            //Old formula for determining Remaining Schedule Hours
            /*Set(
                varActivityRemainingScheduleHours,
                (DateDiff(DateValue(Today()),DateValue(ThisItem.PlanEndDate),Days) + 1) * varActivityBaseNumMen * 8
            );*/
            Set(
                varActivityDailyGoal,
                RoundUp(varActivityRemainingQTY/(varActivityRemainingScheduleHours/varActivityBaseNumMen/8),2)
            );
            Set(
                varActivityActualHours,
                If(
                    IsEmpty(
                        Filter(
                            tblDailyActivities,
                            ProjectInternalID = ThisItem.ProjectInternalID && ActivityAutoID = ThisItem.ActivityAutoID
                        )
                    ),
                    0,
                    Sum(
                        Filter(
                            tblDailyActivities,
                            ProjectInternalID = ThisItem.ProjectInternalID && ActivityAutoID = ThisItem.ActivityAutoID
                        ),
                        EndDay_HoursWork
                    )
                )
            );
            Set(
                varActivityEstHoursToDate, 
                0
            );
            Set(
                varActivityEstQTYToDate,
                0
            );
            UpdateContext({varActivityLoadingVis:false});
            Navigate(scrDailyPlanQuestions,ScreenTransition.Cover)
        TemplatePadding: =0
        TemplateSize: =75
        Width: =730
        X: =20
        Y: =675
        ZIndex: =8

        recDailyPlanActivitiesStartingTodaySeparator As rectangle:
            Fill: =RGBA(166, 166, 166, 1)
            Height: =1
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - 1
            ZIndex: =1

        lblDailyPlanActivitiesStartingTodayLoading As label:
            Height: =28
            OnSelect: =Select(Parent)
            Text: ="Loading..."
            Visible: |-
                =If(
                    varActivityLoadingVis,
                    If(
                        ThisItem.ActivityAutoID = varActivityScheduleDetails.ActivityAutoID,
                        true,
                        false
                    ),
                    false
                )
            Width: =95
            X: =633
            Y: =45
            ZIndex: =2

        lblDailyPlanActivitiesStartingTodayManHoursFIX As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Normal
            Height: =75
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10
            Text: =ThisItem.TotalManHours - Sum(Filter(tblDailyActivities,ActivityAutoID=ThisItem.ActivityAutoID),EndDay_HoursWork) & " hours remaining "&Char(13) & ThisItem.TotalManHours & " estimated hours "
            Width: =110
            X: =560
            ZIndex: =3

        lblDailyPlanActivitiesStartingTodayCCValue As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Normal
            Height: =75
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =12
            Text: =ThisItem.ActivityCostCode
            Width: =110
            X: =430
            ZIndex: =4

        lblDailyPlanActivitiesStartingTodayAreaValue As label:
            Align: =Align.Center
            Height: =75
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =2
            PaddingRight: =2
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.Area
            Width: =115
            X: =315
            ZIndex: =5

        lblDailyPlanActivitiesStartingTodayActivityDescValue As label:
            Align: =Align.Center
            Height: =75
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =2
            PaddingRight: =2
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.ActivityDescription
            Width: =200
            X: =115
            ZIndex: =6

        lblDailyPlanActivitiesStartingTodayActivityNumValue As label:
            Height: =75
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =13
            Text: =ThisItem.ActivityNum
            Width: =115
            ZIndex: =7

        del_htmlDailyPlanActivitiesStartingTodayManHours As htmlViewer:
            Height: =75
            HtmlText: |-
                ="<div style='text-align: center;'>
                    <label style='font-weight: bold;'>
                        "& ThisItem.TotalManHours &"
                    </label>
                    <label>
                        Total Estimated 
                    </label>
                    <br>
                    <label style='font-weight: bold;'>
                        "& RoundUp(
                            Sum(
                                Filter(
                                    colCheckInActivities,
                                    ProjectInternalID = varSelectedDailyPlanProjectInternalID,
                                    Today() >= DateValue(Text(PlanStartDate)), //&& Today() <= DateValue(Text(PlanEndDate))
                                    ActivityAutoID = ThisItem.ActivityAutoID
                                ),
                                EstHoursToDate
                            ),
                            0
                         ) &"
                    </label>
                    <label>
                        ManPower Plan to Date 
                    </label>
                    <br>
                    <label style='font-weight: bold;'>
                        "& If(
                            IsEmpty(
                                Filter(
                                    tblDailyActivities,
                                    ActivityAutoID = ThisItem.ActivityAutoID
                                )
                            ),
                            0,
                            Sum(
                                Filter(
                                    tblDailyActivities,
                                    ActivityAutoID = ThisItem.ActivityAutoID
                                ),
                                EndDay_HoursWork
                            )
                        ) &"
                    </label>
                    <label>
                         Actual Used to Date
                    </label>
                    <br>
                    <label style='font-weight: bold;'>
                        "& ThisItem.TotalManHours - Sum(
                            Filter(
                                tblDailyActivities,
                                ActivityAutoID = ThisItem.ActivityAutoID
                            ),
                            EndDay_HoursWork
                        )  &"
                    </label>
                    <label>
                        Remaining 
                    </label>
                </div>"
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =25
            PaddingTop: =0
            Size: =9
            Visible: =false
            Width: =189
            X: =540
            ZIndex: =8

        icoDailyPlanActivitiesStartingTodayNext As icon.ChevronRight:
            AccessibleLabel: =Self.Tooltip
            FocusedBorderThickness: =0
            Height: =55
            Icon: =Icon.ChevronRight
            OnSelect: =Select(Parent)
            PaddingBottom: =10
            PaddingLeft: =5
            PaddingRight: =5
            PaddingTop: =10
            TabIndex: =0
            Tooltip: ="View item details"
            Width: =53
            X: =675
            Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
            ZIndex: =9

        btnDailyPlanActivitiesStartingTodayClick As button:
            Color: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(0, 0, 0, 0)
            Height: =75
            HoverFill: =RGBA(116, 116, 116, 0.1)
            OnSelect: =Select(Parent)
            Text: =""
            Width: =729
            ZIndex: =10

    recDailyPlanActivitiesStartingTodayAreaSeparator As rectangle:
        Fill: =RGBA(166, 166, 166, 1)
        Height: =lblDailyPlanActivitiesStartingTodayArea.Height + galDailyPlanActivitiesSchedule.Height
        OnSelect: =
        Width: =1
        X: =lblDailyPlanActivitiesStartingTodayArea.X+lblDailyPlanActivitiesStartingTodayArea.Width
        Y: =lblDailyPlanActivitiesStartingTodayArea.Y
        ZIndex: =9

    lblDailyPlanActivitiesStartingTodayArea As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Semibold
        Size: =15
        Text: ="Area"
        VerticalAlign: =VerticalAlign.Bottom
        Width: =115
        X: =335
        Y: =635
        ZIndex: =10

    recDailyPlanActivitiesStartingTodayActivityDescSeparator As rectangle:
        Fill: =RGBA(166, 166, 166, 1)
        Height: =lblDailyPlanActivitiesStartingTodayActivityDesc.Height + galDailyPlanActivitiesSchedule.Height
        OnSelect: =
        Width: =1
        X: =lblDailyPlanActivitiesStartingTodayActivityDesc.X+lblDailyPlanActivitiesStartingTodayActivityDesc.Width
        Y: =lblDailyPlanActivitiesStartingTodayActivityDesc.Y
        ZIndex: =11

    lblDailyPlanActivitiesStartingTodayActivityDesc As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Semibold
        Size: =15
        Text: ="Activity"
        VerticalAlign: =VerticalAlign.Bottom
        Width: =200
        X: =135
        Y: =635
        ZIndex: =12

    recDailyPlanActivitiesStartingTodayActivityNumSeparator As rectangle:
        Fill: =RGBA(166, 166, 166, 1)
        Height: =lblDailyPlanActivitiesStartingTodayActivityNum.Height + galDailyPlanActivitiesSchedule.Height
        OnSelect: =
        Width: =1
        X: =lblDailyPlanActivitiesStartingTodayActivityNum.X+lblDailyPlanActivitiesStartingTodayActivityNum.Width
        Y: =lblDailyPlanActivitiesStartingTodayActivityNum.Y
        ZIndex: =13

    lblDailyPlanActivitiesStartingTodayActivityNum As label:
        FontWeight: =FontWeight.Semibold
        Size: =15
        Text: |-
            ="Activity #"
        VerticalAlign: =VerticalAlign.Bottom
        Width: =115
        X: =20
        Y: =635
        ZIndex: =14

    grpDailyPlanActivitiesEmptySchedulePopup As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =14

        recDailyPlanActivitiesEmptyScheduleBackground As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =637
            Visible: =If(IsEmpty(galDailyPlanActivitiesSchedule.AllItems) && IsEmpty(galDailyPlanActivitiesStartingToday.AllItems), true, false)
            Width: =732
            X: =19
            Y: =369
            ZIndex: =26

        lblDailyPlanActivitiesEmptyScheduleMessage As label:
            Align: =Align.Center
            Height: =87
            Size: =18
            Text: ="That's all the activities scheduled for today." & Char(13) & "Will you be working on any other activities?"
            Visible: =If(IsEmpty(galDailyPlanActivitiesSchedule.AllItems) && IsEmpty(galDailyPlanActivitiesStartingToday.AllItems), true, false)
            Width: =530
            X: =119
            Y: =369
            ZIndex: =27

        btnDailyPlanActivitiesEmptyScheduleYes As button:
            DisplayMode: =Edit
            Fill: =RGBA(168, 0, 0, 1)
            Height: =49.48
            HoverFill: =ColorFade(RGBA(168, 0, 0, 1), -20%)
            OnSelect: =Navigate(scrActivitiesSearch)
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =14.99
            Text: ="Yes"
            Visible: =If(IsEmpty(galDailyPlanActivitiesSchedule.AllItems) && IsEmpty(galDailyPlanActivitiesStartingToday.AllItems), true, false)
            Width: =200
            X: =166
            Y: =499
            ZIndex: =28

        btnDailyPlanActivitiesEmptyScheduleNo As button:
            DisplayMode: =Edit
            Fill: =RGBA(168, 0, 0, 1)
            Height: =49.48
            HoverFill: =ColorFade(RGBA(168, 0, 0, 1), -20%)
            OnSelect: =Navigate(scrHome);
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =14.99
            Text: ="No"
            Visible: =If(IsEmpty(galDailyPlanActivitiesSchedule.AllItems) && IsEmpty(galDailyPlanActivitiesStartingToday.AllItems), true, false)
            Width: =200
            X: =403
            Y: =499
            ZIndex: =30

    lblDailyPlanActivitiesStartingTodayTitle As label:
        FontWeight: =FontWeight.Bold
        Height: =36
        Size: =16
        Text: |-
            ="Activities Starting Today
            "
        Width: =730
        X: =20
        Y: =605
        ZIndex: =15

    "galDailyPlanActivitiesSchedule As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
        BorderColor: =RGBA(166, 166, 166, 1)
        BorderThickness: =2
        Height: =200
        Items: |-
            =Filter(
                AddColumns(
                    tblActivities,
                    "WithinDate",
                    If( //Checking Today against the Start and End dates of all scheduled activities
                        Today() > DateValue(Text(PlanStartDate)) && Today() <= DateValue(Text(PlanEndDate)),
                        true, 
                        false
                    )
                ),
                ProjectInternalID = varSelectedDailyPlanProjectInternalID, //Filter to the selected Project
                Not( //Filtering out any Activity that was started today
                    ActivityAutoID in Filter(
                        colFilteredDailyActivities,
                        Today() = DateValue(Text(ActivityDate))
                    ).ActivityAutoID
                ),
                WithinDate = true,
                Finalized <> true
            )
        Layout: =Layout.Vertical
        OnSelect: |-
            =UpdateContext({varActivityLoadingVis:true});
            Set(varActivityScheduleDetails, ThisItem);
            Set(varActivityNum, ThisItem.ActivityNum);
            Set(varActivityDesc, ThisItem.ActivityDescription);
            Set(varActivityStatus, 4); //This needs to be updated. 4 is a placeholder for 'Not Started'
            Set(varActivityTotalMetricsQTY, ThisItem.TotalMetricsQTY);
            Set(varActivityMeasure, ThisItem.Measure);
            Set(varActivityBaseNumMen, ThisItem.BaseNumMen);
            Set(varActivityUpdatedBaseNumMen, Blank());
            Set(varActivityTrade, ThisItem.Trade);
            Set(varActivityCostCode, ThisItem.ActivityCostCode);
            Set(varActivityPlanStartDate, ThisItem.PlanStartDate);
            Set(varActivityPlanEndDate, ThisItem.PlanEndDate);
            Set(varActivityProductionPerDay, ThisItem.ProductionPerDay);
            Set(varActivityDuration, ThisItem.ActivityDuration);
            Set(varActivityTotalManHours, ThisItem.TotalManHours);
            Set(varActivityTarget, ThisItem.Target);
            Set(varActivityFinalized, ThisItem.Finalized);
            Set(varActivityArea, ThisItem.Area);
            Clear(colCountDailyActivities);
            ForAll(
                Filter(
                    tblDailyActivities,
                    ProjectInternalID = ThisItem.ProjectInternalID && ActivityAutoID = ThisItem.ActivityAutoID
                ),
                Collect(
                    colCountDailyActivities,
                    {
                        Value: 1
                    }
                )
            );
            Set(
                varActivityRemainingQTY,
            	RoundUp(
                    ThisItem.TotalMetricsQTY - Sum(
                        Filter(
                            tblDailyActivities,
                            ProjectInternalID = ThisItem.ProjectInternalID && ActivityAutoID = ThisItem.ActivityAutoID
                        ),
                        EndDay_AmtComplete
                    ),
                    2
                )
            );
            Set(
                varActivityRemainingHours,
                varActivityScheduleDetails.TotalManHours - Sum(
                    Filter(
                        tblDailyActivities,
                        ProjectInternalID = ThisItem.ProjectInternalID && ActivityAutoID = ThisItem.ActivityAutoID
                    ),
                    EndDay_HoursWork
                )
            );
            Set(
                varActivityRemainingScheduleDays,
                RoundDown((DateDiff(DateValue(Today()),DateValue(ThisItem.PlanEndDate),Days)) /7, 0) * 5 + Mod(5 + Weekday(DateValue(ThisItem.PlanEndDate)) - Weekday(Today()), 5) - CountIf(tblHolidays,Date >= Today(), Date <= ThisItem.PlanEndDate) +1
            );
            Set(
                varActivityRemainingScheduleHours,
                varActivityRemainingScheduleDays * varActivityBaseNumMen * 8
            );
            //Old formula for determining Remaining Schedule Hours
            /*Set(
                varActivityRemainingScheduleHours,
                (
                    (
                        DateDiff(
                            DateValue(Today()),
                            DateValue(ThisItem.PlanEndDate),
                            Days
                        ) + 1
                    ) * varActivityBaseNumMen * 8
            );*/
            Set(
                varActivityDailyGoal,
                RoundUp(varActivityRemainingQTY/(varActivityRemainingScheduleHours/varActivityBaseNumMen/8),2)
            );
            Set(
                varActivityActualHours,
                Sum(
                    Filter(
                        tblDailyActivities,
                        ProjectInternalID = ThisItem.ProjectInternalID && ActivityAutoID = ThisItem.ActivityAutoID
                    ),
                    EndDay_HoursWork
                )
            );
            Set(
                varActivityEstHoursToDate, 
                RoundUp(
                    Sum(
                        Filter(
                            colCheckInActivities,
                            ProjectInternalID = varSelectedDailyPlanProjectInternalID,
                            Today() >= DateValue(Text(PlanStartDate)), //&& Today() <= DateValue(Text(PlanEndDate))
                            ActivityAutoID = ThisItem.ActivityAutoID
                        ),
                        EstHoursToDate
                    ),
                    0
                )
            );
            Set(
                varActivityEstQTYToDate,
                Sum(
                    Filter(
                        colCheckInActivities,
                        ProjectInternalID = varSelectedDailyPlanProjectInternalID,
                        Today() >= DateValue(Text(PlanStartDate)), //&& Today() <= DateValue(Text(PlanEndDate))
                        ActivityAutoID = ThisItem.ActivityAutoID
                    ),
                    EstQTYToDate
                )
            );
            UpdateContext({varActivityLoadingVis:false});
            Navigate(scrDailyPlanQuestions,ScreenTransition.Cover)
        TemplatePadding: =0
        TemplateSize: =75
        Width: =730
        X: =20
        Y: =395
        ZIndex: =16

        recDailyPlanActivitiesScheduleSeparator As rectangle:
            Fill: =RGBA(166, 166, 166, 1)
            Height: =1
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - 1
            ZIndex: =1

        lblDailyPlanActivitiesScheduleLoading As label:
            Height: =28
            OnSelect: =Select(Parent)
            Text: ="Loading..."
            Visible: |-
                =If(
                    varActivityLoadingVis,
                    If(
                        ThisItem.ActivityAutoID = varActivityScheduleDetails.ActivityAutoID,
                        true,
                        false
                    ),
                    false
                )
            Width: =95
            X: =633
            Y: =45
            ZIndex: =2

        lblDailyPlanActivitiesScheduleManHoursFIX As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Normal
            Height: =75
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10
            Text: =ThisItem.TotalManHours - Sum(Filter(tblDailyActivities,ActivityAutoID=ThisItem.ActivityAutoID),EndDay_HoursWork) & " hours remaining "&Char(13) & ThisItem.TotalManHours & " estimated hours "
            Width: =110
            X: =560
            ZIndex: =3

        lblDailyPlanActivitiesScheduleCCValue As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Normal
            Height: =75
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =12
            Text: =ThisItem.ActivityCostCode
            Width: =110
            X: =430
            ZIndex: =4

        lblDailyPlanActivitiesScheduleAreaValue As label:
            Align: =Align.Center
            Height: =75
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =2
            PaddingRight: =2
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.Area
            Width: =115
            X: =315
            ZIndex: =5

        lblDailyPlanActivitiesScheduleActivityDescValue As label:
            Align: =Align.Center
            Height: =75
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =2
            PaddingRight: =2
            PaddingTop: =0
            Size: =11
            Text: =ThisItem.ActivityDescription
            Width: =200
            X: =115
            ZIndex: =6

        lblDailyPlanActivitiesScheduleActivityNumValue As label:
            Height: =75
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =13
            Text: =ThisItem.ActivityNum
            Width: =115
            ZIndex: =7

        del_htmlDailyPlanActivitiesScheduleManHours_1 As htmlViewer:
            Height: =75
            HtmlText: |-
                ="<div style='text-align: center;'>
                    <label style='font-weight: bold;'>
                        "& ThisItem.TotalManHours &"
                    </label>
                    <label>
                        Total Estimated 
                    </label>
                    <br>
                    <label style='font-weight: bold;'>
                        "& RoundUp(
                            Sum(
                                Filter(
                                    colCheckInActivities,
                                    ProjectInternalID = varSelectedDailyPlanProjectInternalID,
                                    Today() >= DateValue(Text(PlanStartDate)), //&& Today() <= DateValue(Text(PlanEndDate))
                                    ActivityAutoID = ThisItem.ActivityAutoID
                                ),
                                EstHoursToDate
                            ),
                            0
                         ) &"
                    </label>
                    <label>
                        ManPower Plan to Date 
                    </label>
                    <br>
                    <label style='font-weight: bold;'>
                        "& If(
                            IsEmpty(
                                Filter(
                                    tblDailyActivities,
                                    ActivityAutoID = ThisItem.ActivityAutoID
                                )
                            ),
                            0,
                            Sum(
                                Filter(
                                    tblDailyActivities,
                                    ActivityAutoID = ThisItem.ActivityAutoID
                                ),
                                EndDay_HoursWork
                            )
                        ) &"
                    </label>
                    <label>
                         Actual Used to Date
                    </label>
                    <br>
                    <label style='font-weight: bold;'>
                        "& ThisItem.TotalManHours - Sum(
                            Filter(
                                tblDailyActivities,
                                ActivityAutoID = ThisItem.ActivityAutoID
                            ),
                            EndDay_HoursWork
                        )  &"
                    </label>
                    <label>
                        Remaining 
                    </label>
                </div>"
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =25
            PaddingTop: =0
            Size: =8.5
            Visible: =false
            Width: =190
            X: =540
            ZIndex: =8

        icoDailyPlanActivitiesScheduleNext As icon.ChevronRight:
            AccessibleLabel: =Self.Tooltip
            FocusedBorderThickness: =0
            Height: =55
            Icon: =Icon.ChevronRight
            OnSelect: =Select(Parent)
            PaddingBottom: =10
            PaddingLeft: =5
            PaddingRight: =5
            PaddingTop: =10
            TabIndex: =0
            Tooltip: ="View item details"
            Width: =53
            X: =675
            Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
            ZIndex: =9

        btnDailyPlanActivitiesScheduleClick As button:
            Color: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(0, 0, 0, 0)
            Height: =75
            HoverFill: =RGBA(116, 116, 116, 0.1)
            OnSelect: =Select(Parent)
            Text: =""
            Width: =729
            ZIndex: =10

    lblDailyPlanActivitiesScheduleManHours As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Semibold
        Size: =15
        Text: ="Man Hours"
        VerticalAlign: =VerticalAlign.Bottom
        Width: =120
        X: =580
        Y: =355
        ZIndex: =17

    recDailyPlanActivitiesScheduleCCSeparator As rectangle:
        Fill: =RGBA(166, 166, 166, 1)
        Height: =lblDailyPlanActivitiesScheduleCC.Height + galDailyPlanActivitiesSchedule.Height
        OnSelect: =
        Width: =1
        X: =lblDailyPlanActivitiesScheduleCC.X+lblDailyPlanActivitiesScheduleCC.Width
        Y: =lblDailyPlanActivitiesScheduleCC.Y
        ZIndex: =18

    lblDailyPlanActivitiesScheduleCC As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Semibold
        Size: =15
        Text: ="Cost Code"
        VerticalAlign: =VerticalAlign.Bottom
        Width: =110
        X: =450
        Y: =355
        ZIndex: =19

    recDailyPlanActivitiesScheduleAreaSeparator As rectangle:
        Fill: =RGBA(166, 166, 166, 1)
        Height: =lblDailyPlanActivitiesScheduleArea.Height + galDailyPlanActivitiesSchedule.Height
        OnSelect: =
        Width: =1
        X: =lblDailyPlanActivitiesScheduleArea.X+lblDailyPlanActivitiesScheduleArea.Width
        Y: =lblDailyPlanActivitiesScheduleArea.Y
        ZIndex: =20

    lblDailyPlanActivitiesScheduleArea As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Semibold
        Size: =15
        Text: ="Area"
        VerticalAlign: =VerticalAlign.Bottom
        Width: =115
        X: =335
        Y: =355
        ZIndex: =21

    recDailyPlanActivitiesScheduleActivityDescSeparator As rectangle:
        Fill: =RGBA(166, 166, 166, 1)
        Height: =lblDailyPlanActivitiesScheduleActivityDesc.Height + galDailyPlanActivitiesSchedule.Height
        OnSelect: =
        Width: =1
        X: =lblDailyPlanActivitiesScheduleActivityDesc.X+lblDailyPlanActivitiesScheduleActivityDesc.Width
        Y: =lblDailyPlanActivitiesScheduleActivityDesc.Y
        ZIndex: =22

    lblDailyPlanActivitiesScheduleActivityDesc As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Semibold
        Size: =15
        Text: ="Activity"
        VerticalAlign: =VerticalAlign.Bottom
        Width: =200
        X: =135
        Y: =355
        ZIndex: =23

    recDailyPlanActivitiesScheduleActivityNumSeparator As rectangle:
        Fill: =RGBA(166, 166, 166, 1)
        Height: =lblDailyPlanActivitiesScheduleActivityNum.Height + galDailyPlanActivitiesSchedule.Height
        OnSelect: =
        Width: =1
        X: =lblDailyPlanActivitiesScheduleActivityNum.X+lblDailyPlanActivitiesScheduleActivityNum.Width
        Y: =lblDailyPlanActivitiesScheduleActivityNum.Y
        ZIndex: =24

    lblDailyPlanActivitiesScheduleActivityNum As label:
        FontWeight: =FontWeight.Semibold
        Size: =15
        Text: |-
            ="Activity #"
        VerticalAlign: =VerticalAlign.Bottom
        Width: =115
        X: =20
        Y: =355
        ZIndex: =25

    lblDailyPlanActivitiesScheduleTitle As label:
        FontWeight: =FontWeight.Bold
        Height: =36
        Size: =16
        Text: |-
            ="Ongoing Activities Scheduled for Today
            "
        Width: =730
        X: =20
        Y: =319
        ZIndex: =29

    icoDPActivitiesRefresh As icon.Reload:
        Height: =50
        Icon: =Icon.Reload
        OnSelect: |-
            =Refresh(tblActivities);
            Refresh(tblDailyActivities); 
            ClearCollect(
                colFilteredDailyActivities,
                Filter(
                    tblDailyActivities,
                    ProjectInternalID = varSelectedDailyPlanProjectInternalID
                )
            );
        PaddingBottom: =5
        PaddingLeft: =5
        PaddingRight: =5
        PaddingTop: =5
        Tooltip: ="Refresh the list of activities"
        Width: =50
        X: =700
        Y: =317
        ZIndex: =31

    grpDailyPlanActivitiesBanner As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =31

        recDailyPlanActivitiesBackground As rectangle:
            Fill: =RGBA(204, 204, 204, 1)
            Height: =85.33
            Width: =768
            Y: =0.00
            ZIndex: =44

        lblDailyPlanActivitiesWelcome As label:
            Align: =Align.Right
            Height: =28.44
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =15
            Text: =Concatenate("Welcome  ",varGlobalUser.Title)
            Width: =Parent.Width/2
            X: =(recDailyPlanActivitiesBackground.X+recDailyPlanActivitiesBackground.Width)-lblDailyPlanActivitiesWelcome.Width
            Y: =56.89
            ZIndex: =45

        imgDailyPlanActivitiesWeather As image:
            Height: =28
            Image: |-
                =varWeatherIcon 
                /*If(
                    "Sun" in Weather.responses.weather.current.cap,
                    "data:image/svg+xml;utf8, %3Csvg%20%20viewBox%3D%270%200%202048%202048%27%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%3E%3Cpath%20d%3D%27M960%20512q93%200%20174%2035t143%2096%2096%20142%2035%20175q0%2093-35%20174t-96%20143-142%2096-175%2035q-93%200-174-35t-143-96-96-142-35-175q0-93%2035-174t96-143%20142-96%20175-35zm0%20768q66%200%20124-25t101-68%2069-102%2026-125q0-66-25-124t-69-101-102-69-124-26q-66%200-124%2025t-102%2069-69%20102-25%20124q0%2066%2025%20124t68%20102%20102%2069%20125%2025zm64-896H896V0h128v384zM896%201536h128v384H896v-384zm1024-640v128h-384V896h384zM384%201024H0V896h384v128zm123-426L236%20326l90-90%20272%20271-91%2091zm906%20724l271%20272-90%2090-272-271%2091-91zm0-724l-91-91%20272-271%2090%2090-271%20272zm-906%20724l91%2091-272%20271-90-90%20271-272z%27%20fill%3D%27%23FFFFFF%27%3E%3C%2Fpath%3E%3C%2Fsvg%3E",
                    "Clear" in Weather.responses.weather.current.cap,
                    "data:image/svg+xml;utf8, %3Csvg%20%20viewBox%3D%270%200%202048%202048%27%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%3E%3Cpath%20d%3D%27M1761%201036q64%2018%20116%2053t91%2084%2059%20109%2021%20126q0%2080-30%20149t-82%20122-123%2083-149%2030H576q-93%200-174-35t-143-96-96-142-35-175q0-66%2019-128t54-117%2084-96%20111-69q-12-49-12-102%200-93%2035-174t96-143%20142-96%20175-35q64%200%20125%2018t113%2051%2095%2081%2070%20106q90%203%20173%2033t152%2082%20122%20124%2079%20157zM832%20512q-66%200-124%2025t-102%2069-69%20102-25%20124q0%2017%201%2033t7%2034q28-3%2056-3%2038%200%2075%206t72%2019q29-51%2069-94t89-78%20102-59%20112-37q-44-66-114-103t-149-38zm832%201152q53%200%2099-20t82-55%2055-81%2020-100q0-55-20-102t-57-81-84-53-102-20q-12-82-51-152t-97-122-134-81-159-29q-77%200-146%2025t-127%2069-98%20106-61%20135q-44-38-97-58t-111-21q-66%200-124%2025t-102%2068-69%20102-25%20125q0%2066%2025%20124t68%20102%20102%2069%20125%2025h1088zM256%20896H0V768h256v128zm123-426L198%20289l91-91%20181%20181-91%2091zm517-214H768V0h128v256zm389%20214l-91-91%20181-181%2091%2091-181%20181z%27%20fill%3D%27%23FFFFFF%27%3E%3C%2Fpath%3E%3C%2Fsvg%3E",
                    "Cloud" in Weather.responses.weather.current.cap,
                    "data:image/svg+xml;utf8, %3Csvg%20%20viewBox%3D%270%200%202048%202048%27%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%3E%3Cpath%20d%3D%27M1761%201036q64%2018%20116%2053t91%2084%2059%20109%2021%20126q0%2080-30%20149t-82%20122-123%2083-149%2030H576q-93%200-174-35t-143-96-96-142-35-175q0-75%2024-144-71-54-111-134T0%20896q0-79%2030-149t82-122%20122-83%20150-30h21q10%200%2022%202%2027-60%2069-107t95-81%20114-52%20127-18q84%200%20159%2029t135%2081%2099%20123%2051%20154q84%208%20160%2040t140%2085%20111%20120%2074%20148zM384%20640q-53%200-99%2020t-82%2055-55%2081-20%20100q0%2054%2021%20102t62%2086q63-89%20159-138t206-50q38%200%2075%206t72%2019q32-57%2078-104t101-83%20117-59%20127-31q-11-56-39-104t-71-82-94-54-110-20q-62%200-117%2022t-98%2062-70%2093-32%20116q-30-17-63-27t-68-10zm1280%201024q53%200%2099-20t82-55%2055-81%2020-100q0-55-20-102t-57-81-84-54-102-19q-12-82-51-152t-97-122-134-81-159-29q-77%200-146%2025t-127%2069-98%20106-61%20135q-44-38-97-58t-111-21q-66%200-124%2025t-102%2068-69%20102-25%20125q0%2066%2025%20124t68%20102%20102%2069%20125%2025h1088z%27%20fill%3D%27%23FFFFFF%27%3E%3C%2Fpath%3E%3C%2Fsvg%3E",
                    "Rain" in Weather.responses.weather.current.cap,
                    "data:image/svg+xml;utf8, %3Csvg%20%20viewBox%3D%270%200%202048%202048%27%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%3E%3Cpath%20d%3D%27M850%201827q14%2030%2014%2061%200%2033-12%2062t-35%2051-51%2034-62%2013q-33%200-62-12t-51-35-34-51-13-62q0-31%2014-61l146-291%20146%20291zm768%200q14%2030%2014%2061%200%2033-12%2062t-35%2051-51%2034-62%2013q-33%200-62-12t-51-35-34-51-13-62q0-31%2014-61l146-291%20146%20291zm-384-256q14%2030%2014%2061%200%2033-12%2062t-35%2051-51%2034-62%2013q-33%200-62-12t-51-35-34-51-13-62q0-31%2014-61l146-291%20146%20291zm527-535q63%2017%20115%2052t91%2085%2060%20109%2021%20126q0%2066-22%20126t-61%20110-93%2085-118%2051l-60-120q48-6%2089-27t72-56%2047-77%2018-92q0-55-20-102t-57-81-84-53-102-20q-12-82-51-152t-97-122-134-81-159-29q-77%200-146%2025t-127%2069-98%20106-61%20135q-44-38-97-58t-111-21q-66%200-124%2025t-102%2068-69%20102-25%20125q0%2053%2017%20102t47%2089%2073%2070%2094%2045l-57%20114q-67-23-122-65t-96-97-62-120-22-138q0-93%2035-174t96-142%20142-96%20175-36q74%200%20147%2025%2039-65%2092-117t117-88%20136-56%20148-20q93%200%20178%2029t158%2081%20126%20125%2083%20161z%27%20fill%3D%27%23FFFFFF%27%3E%3C%2Fpath%3E%3C%2Fsvg%3E",
                    "Thunder" in Weather.responses.weather.current.cap,
                    "data:image/svg+xml;utf8, %3Csvg%20%20viewBox%3D%270%200%202048%202048%27%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%3E%3Cpath%20d%3D%27M1761%201036q63%2017%20115%2052t91%2085%2060%20109%2021%20126q0%2080-30%20149t-82%20122-123%2083-149%2030h-384l128-128h256q53%200%2099-20t82-55%2055-81%2020-100q0-55-20-101t-57-81-83-54-102-20q-12-82-51-152t-98-122-134-81-159-29q-77%200-146%2025t-127%2069-98%20106-61%20135q-44-38-97-58t-111-21q-66%200-124%2025t-102%2068-69%20102-25%20125q0%2066%2025%20124t68%20102%20102%2069%20125%2025h256l-64%20128H576q-93%200-174-35t-142-96-96-142-36-175q0-75%2024-144-71-54-111-134T0%20896q0-79%2030-149t82-122%20122-83%20150-30h21q10%200%2022%202%2027-60%2069-107t95-81%20114-52%20127-18q84%200%20159%2029t135%2081%2099%20123%2051%20154q84%209%20160%2041t139%2084%20112%20120%2074%20148zM723%20921q34-57%2079-104t100-83%20116-59%20128-31q-11-56-40-104t-70-82-94-54-110-20q-62%200-117%2022t-98%2062-70%2093-32%20116q-30-17-63-27t-68-10q-53%200-99%2020t-82%2055-55%2081-20%20100q0%2054%2021%20103t63%2085q63-89%20159-138t205-50q74%200%20147%2025zm109%201127l256-512H864l192-384h224l-128%20256h320l-640%20640z%27%20fill%3D%27%23FFFFFF%27%3E%3C%2Fpath%3E%3C%2Fsvg%3E",
                    "Snow" in Weather.responses.weather.current.cap,
                    "data:image/svg+xml;utf8, %3Csvg%20%20viewBox%3D%270%200%202048%202048%27%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%3E%3Cpath%20d%3D%27M1511%201504q26%200%2044%2019t19%2045q0%2036-32%2055l-70%2041%2070%2041q32%2019%2032%2055%200%2027-19%2045t-45%2019q-13%200-26-5t-27-13-26-16-23-15q0%2019%201%2044t-3%2047-18%2038-44%2016q-30%200-44-15t-18-38-4-48%202-44q-11%206-23%2014t-25%2016-27%2013-27%206q-26%200-45-18t-19-46q0-36%2032-55l70-41-70-41q-32-19-32-55%200-26%2018-45t45-19q13%200%2027%205t27%2014%2026%2016%2023%2014q0-19-1-44t2-47%2019-38%2044-16q30%200%2043%2015t18%2038%204%2048-1%2044q10-6%2022-14t26-16%2028-13%2027-6zm-533%20323q14%2030%2014%2061%200%2033-12%2062t-35%2051-51%2034-62%2013q-33%200-62-12t-51-35-34-51-13-62q0-31%2014-61l146-291%20146%20291zm783-791q63%2017%20115%2052t91%2085%2060%20109%2021%20126q0%2061-18%20117t-52%20104-81%2083-105%2056v-139q59-35%2093-93t35-128q0-55-20-101t-57-81-83-54-102-20q-12-82-51-152t-98-122-134-81-159-29q-77%200-146%2025t-127%2069-98%20106-61%20135q-44-38-97-58t-111-21q-66%200-124%2025t-102%2068-69%20102-25%20125q0%2066%2025%20124t68%20102%20102%2069%20125%2025l-61%20122q-83-11-154-50t-122-98-81-135-30-159q0-93%2035-174t96-142%20142-96%20175-36q74%200%20147%2025%2039-65%2092-117t117-88%20136-56%20148-20q93%200%20178%2029t158%2081%20126%20125%2083%20161z%27%20fill%3D%27%23FFFFFF%27%3E%3C%2Fpath%3E%3C%2Fsvg%3E"
                )*/
            PaddingRight: =5
            Width: =28
            X: =recHomeBanner.Width-Self.Width
            Y: =28
            ZIndex: =46

        lblDailyPlanActivitiesTemp As label:
            Align: =Align.Right
            Height: =28.44
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =15
            Text: =Weather.responses.weather.current.temp & Weather.units.temperature
            Width: =Parent.Width/2
            X: =(recDailyPlanActivitiesBackground.X+recDailyPlanActivitiesBackground.Width)-lblDailyPlanActivitiesTemp.Width-imgDailyPlanActivitiesWeather.Width
            Y: =28
            ZIndex: =47

        lblDailyPlanActivitiesTodaysDate As label:
            Align: =Align.Right
            Height: =28.44
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =15
            Text: =varGlobalTime //Text(Now(),ShortDateTime)
            Width: =Parent.Width/2
            X: =(recDailyPlanActivitiesBackground.X+recDailyPlanActivitiesBackground.Width)-lblDailyPlanActivitiesTodaysDate.Width
            Y: =0.00
            ZIndex: =48

        imgDailyPlanActivitiesBanner As image:
            Height: =86
            Image: ='SMART HEader'
            OnSelect: |-
                =Navigate(scrHome);
                Set(varSelectedDailyPlanProjectID,Blank());
                Set(varSelectedDailyPlanProjectName,Blank());
                Set(varSelectedDailyPlanProjectInternalID,Blank());
            Width: =574
            ZIndex: =49

    del_lblDailyPlanActivitiesTotalActivities As label:
        Align: =Align.Right
        Height: =28
        Size: =15
        Text: =CountRows(Filter(tblActivities,ProjectInternalID = varSelectedDailyPlanProjectInternalID)) & " total activities"
        Visible: =false
        Width: =261
        X: =507
        Y: =84
        ZIndex: =32

    del_lblDailyPlanActivitiesCompletedActivities As label:
        Align: =Align.Right
        Height: =22
        Size: =15
        Text: |-
            =If(
                CountRows(galDailyPlanActivitiesSchedule.AllItems) = 0,
                "All daily activities completed",
                CountRows(
                    Filter(
                        tblActivities,
                        ProjectInternalID = varSelectedDailyPlanProjectInternalID,
                        Today() >= DateValue(Text(PlanStartDate)) && Today() <= DateValue(Text(PlanEndDate))
                    )
                ) - CountRows(galDailyPlanActivitiesSchedule.AllItems) & " daily activities completed"
            )
        Visible: =false
        Width: =275
        X: =493
        Y: =113
        ZIndex: =33

    lblDailyPlanActivitiesSubtitle As label:
        Align: =Align.Center
        Size: =15
        Text: ="Please select an activity and answer the questions"
        Width: =768
        Y: =280
        ZIndex: =34

    btnDPQActivitiesBackground As button:
        DisplayMode: =DisplayMode.Disabled
        Fill: =RGBA(168, 0, 0, 1)
        Height: =90
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =14.99
        Text: =""
        Width: =350
        X: =Parent.Width-Self.Width-20
        Y: =190
        ZIndex: =35

    lblDailyPlanActivitiesTotalActivities As label:
        Align: =Align.Center
        Height: =28
        Size: =15
        Text: =CountRows(Filter(tblActivities,ProjectInternalID = varSelectedDailyPlanProjectInternalID)) & " total activities"
        Width: =btnDPQActivitiesBackground.Width
        X: =btnDPQActivitiesBackground.X
        Y: =205
        ZIndex: =36

    lblDailyPlanActivitiesCompletedActivities As label:
        Align: =Align.Center
        Height: =22
        Size: =15
        Text: |-
            =If(
                CountRows(Filter(colFilteredDailyActivities, ActivityDate = Today())) > 0 && 
                    (CountRows(galDailyPlanActivitiesSchedule.AllItems) + CountRows(galDailyPlanActivitiesStartingToday.AllItems)) = 0,
                "All daily activities completed",
                (CountRows(galDailyPlanActivitiesSchedule.AllItems) + CountRows(galDailyPlanActivitiesStartingToday.AllItems)) = 0,
                "No Activities scheduled for today",
                CountRows(
                    Filter(
                        tblActivities,
                        ProjectInternalID = varSelectedDailyPlanProjectInternalID,
                        Today() >= DateValue(Text(PlanStartDate)) && Today() <= DateValue(Text(PlanEndDate))
                    )
                ) - (CountRows(galDailyPlanActivitiesSchedule.AllItems) + CountRows(galDailyPlanActivitiesStartingToday.AllItems)) & " daily activities completed"
            )
        Width: =btnDPQActivitiesBackground.Width
        X: =btnDPQActivitiesBackground.X
        Y: =234
        ZIndex: =37

    btnDPQActivitiesScheduleManHoursBackground As button:
        DisplayMode: =DisplayMode.Disabled
        Fill: =RGBA(168, 0, 0, 1)
        Height: =90
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =14.99
        Text: =""
        Width: =350
        X: =20
        Y: =189
        ZIndex: =38

    htmlDailyPlanActivitiesScheduleManHours As htmlViewer:
        Height: =btnDPQActivitiesScheduleManHoursBackground.Height
        HtmlText: |-
            ="<div style='text-align: center;'>
                <label style='font-weight: bold;'>
                    "& Sum(
                        Filter(
                            tblActivities,
                            ProjectInternalID = varSelectedDailyPlanProjectInternalID
                        ),
                        TotalManHours
                    ) &"
                </label>
                <label>
                    Total Hours Estimated 
                </label>
                <br>
                <label style='font-weight: bold;'>
                    "& RoundUp(
                        Sum(
                            Filter(
                                colCheckInActivities,
                                ProjectInternalID = varSelectedDailyPlanProjectInternalID,
                                Today() >= DateValue(Text(PlanStartDate)) //&& Today() <= DateValue(Text(PlanEndDate))
                            ),
                            EstHoursToDate
                        ),
                        0
                     ) &"
                </label>
                <label>
                     Actual Hours Used to Date
                </label>
                <br>
                <label style='font-weight: bold;'>
                    "& Sum(
                        Filter(
                            tblActivities,
                            ProjectInternalID = varSelectedDailyPlanProjectInternalID
                        ),
                        TotalManHours
                    ) - Sum(
                        Filter(
                            tblDailyActivities,
                            ProjectInternalID = varSelectedDailyPlanProjectInternalID
                        ),
                        EndDay_HoursWork
                    ) &"
                </label>
                    <label>
                    Original ManPower Plan hours as of Today 
                </label>
                <br>
                <label style='font-weight: bold;'>
                    "& Sum(
                        Filter(
                            tblDailyActivities,
                            ProjectInternalID = varSelectedDailyPlanProjectInternalID
                        ),
                        EndDay_HoursWork
                    ) &"
                </label>
                <label>
                    Hours Remaining 
                </label>
            </div>"
        PaddingBottom: =0
        PaddingLeft: =0
        PaddingRight: =0
        PaddingTop: =0
        Width: =btnDPQActivitiesScheduleManHoursBackground.Width
        X: =btnDPQActivitiesScheduleManHoursBackground.X
        Y: =btnDPQActivitiesScheduleManHoursBackground.Y+3
        ZIndex: =39

    del_htmlDailyPlanActivitiesScheduleManHours As htmlViewer:
        Height: =90
        HtmlText: |-
            ="<div style='text-align: center;'>
                <label style='font-weight: bold;'>
                    "& Sum(
                        Filter(
                            tblActivities,
                            ProjectInternalID = varSelectedDailyPlanProjectInternalID
                        ),
                        TotalManHours
                    ) &"
                </label>
                <label>
                    Total Hours Estimated 
                </label>
                <br>
                <label style='font-weight: bold;'>
                    "& RoundUp(
                        Sum(
                            Filter(
                                colCheckInActivities,
                                ProjectInternalID = varSelectedDailyPlanProjectInternalID,
                                Today() >= DateValue(Text(PlanStartDate)) //&& Today() <= DateValue(Text(PlanEndDate))
                            ),
                            EstHoursToDate
                        ),
                        0
                     ) &"
                </label>
                <label>
                     Actual Hours Used to Date
                </label>
                <br>
                <label style='font-weight: bold;'>
                    "& Sum(
                        Filter(
                            tblActivities,
                            ProjectInternalID = varSelectedDailyPlanProjectInternalID
                        ),
                        TotalManHours
                    ) - Sum(
                        Filter(
                            tblDailyActivities,
                            ProjectInternalID = varSelectedDailyPlanProjectInternalID
                        ),
                        EndDay_HoursWork
                    ) &"
                </label>
                    <label>
                    Original ManPower Plan hours as of Today 
                </label>
                <br>
                <label style='font-weight: bold;'>
                    "& Sum(
                        Filter(
                            tblDailyActivities,
                            ProjectInternalID = varSelectedDailyPlanProjectInternalID
                        ),
                        EndDay_HoursWork
                    ) &"
                </label>
                <label>
                    Hours Remaining 
                </label>
            </div>"
        PaddingBottom: =0
        PaddingLeft: =0
        PaddingRight: =0
        PaddingTop: =0
        Visible: =false
        Width: =375
        X: =196
        Y: =195
        ZIndex: =40

    lblDailyPlanActivitiesProjectInfo As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Semibold
        Height: =50
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =22
        Text: |-
            =varSelectedDailyPlanProjectInternalID & ": " & varSelectedDailyPlanProjectName
        Width: =625
        X: =71
        Y: =145
        ZIndex: =41

    lblDailyPlanActivitiesTitle As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Semibold
        Height: =50
        Size: =32
        Text: ="Activities"
        Width: =381
        X: =193
        Y: =95
        ZIndex: =42

    icoDailyPlanActivitiesBack As icon.BackArrow:
        Height: =47.98
        Icon: =Icon.BackArrow
        OnSelect: |-
            =Set(varSelectedDailyPlanProjectID,Blank());
            Set(varSelectedDailyPlanProjectName,Blank());
            Set(varSelectedDailyPlanProjectInternalID,Blank());
            Navigate(scrDailyPlan,ScreenTransition.UnCoverRight)
        PaddingBottom: =0.00
        PaddingLeft: =0.00
        Tooltip: ="Back to Projects"
        X: =20
        Y: =100.33
        ZIndex: =43

    btnAppExit_DailyPlanActivities As button:
        Fill: =RGBA(168, 0, 0, 1)
        Height: =25
        HoverFill: =ColorFade(Self.Fill, -20%)
        OnSelect: =Exit()
        Size: =11
        Text: ="Exit"
        Width: =75
        X: =585
        Y: =31
        ZIndex: =50

