scrScheduleEditSchedule As screen:
    OnVisible: |-
        =UpdateContext({ResetNewProject:true});UpdateContext({ResetNewProject:false})

    Icon3_4 As icon.Add:
        Height: =56
        Icon: =Icon.Add
        OnSelect: =Set(ResetNewActivity,true);Set(ResetNewActivity,false);Navigate(scrScheduleNewActivity)
        Width: =56
        X: =316
        Y: =282
        ZIndex: =1

    txtArea_5 As text:
        Default: =LookUp('[dbo].[tblTrades]',TradeID = cboxActivityNum_1.Selected.TradeID,Trade)
        DisplayMode: =DisplayMode.View
        Height: =56
        HintText: |-
            ="Choose an activity #"
        PaddingBottom: =3.75
        PaddingLeft: =9.00
        Reset: =ResetNewProject
        Size: =17.99
        Width: =325
        X: =37
        Y: =537
        ZIndex: =2

    lblNewProject_9 As label:
        Align: =Align.Center
        Height: =56.22
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =26.99
        Text: =Concatenate(LookUp('[dbo].[tblProjects]',ProjectID=SelectedProjectID,ProjectNum),Concatenate(" ",LookUp('[dbo].[tblProjects]',ProjectID=SelectedProjectID,ProjectName)))
        Width: =Parent.Width
        Y: =100
        ZIndex: =3

    lblNewProject_11 As label:
        Align: =Align.Center
        Height: =56.22
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =26.99
        Text: ="Edit an activity on the Schedule"
        Width: =Parent.Width
        Y: =153.60
        ZIndex: =8

    btnSubmit_4 As button:
        Fill: =RGBA(168, 0, 0, 1)
        Height: =49.48
        OnSelect: |-
            =UpdateContext({EditScheduleCheckPopup:true})
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =14.99
        Text: ="Submit"
        Width: =264
        X: =(Parent.Width-btnSubmit_4.Width)/2
        Y: =899.56
        ZIndex: =9

    lblActivityNum_8 As label:
        Height: =37
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =17.99
        Text: |-
            ="Activity #"
        Width: =293
        X: =38
        Y: =247.30
        ZIndex: =10

    grpBanner_7 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =10

        recBanner_7 As rectangle:
            Height: =85.33
            Width: =768
            Y: =0.00
            ZIndex: =4

        imgClientLogo_7 As image:
            Height: =77.84
            Image: =ComfortSystemsLogo
            ImagePosition: =ImagePosition.Fill
            PaddingBottom: =0.00
            PaddingLeft: =0.00
            Width: =imgClientLogo_7.Height*2
            X: =recBanner_7.X+5
            Y: =3.75
            ZIndex: =5

        "'lblToday''sDate_7' As label":
            Align: =Align.Right
            Color: =RGBA(255, 255, 255, 1)
            Height: =28.44
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =13.49
            Text: =Today()
            Width: =Parent.Width/2
            X: =(recBanner_7.X+recBanner_7.Width)-'lblToday''sDate_7'.Width
            Y: =0.00
            ZIndex: =6

        lblWelcome_7 As label:
            Align: =Align.Right
            Color: =RGBA(255, 255, 255, 1)
            Height: =28.44
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =13.49
            Text: =Concatenate("Welcome  ",User().FullName)
            Width: =Parent.Width/2
            X: =(recBanner_7.X+recBanner_7.Width)-lblWelcome_7.Width
            Y: =56.89
            ZIndex: =7

    icoBack_6 As icon.BackArrow:
        Height: =47.98
        Icon: =Icon.BackArrow
        OnSelect: |-
            =UpdateContext({ResetEditSchedule:true});UpdateContext({ResetEditSchedule:false});Navigate(scrScheduleProjectActivities,ScreenTransition.UnCoverRight)
        PaddingBottom: =0.00
        PaddingLeft: =0.00
        X: =20
        Y: =100.33
        ZIndex: =11

    lblActivityDesc_2 As label:
        Height: =37.48
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =17.99
        Text: ="Activity Description"
        Width: =Parent.Width/2
        X: =(Parent.Width-lblActivityDesc_2.Width)/10
        Y: =359.75
        ZIndex: =12

    txtActivityDesc_2 As text:
        Default: =LookUp('[dbo].[tblActivities]',ActivityID=First(cboxActivityNum_1.SelectedItems.ActivityID).ActivityID,ActivityDesc)
        DisplayMode: =DisplayMode.View
        Height: =56.22
        HintText: |-
            ="Choose an activity #"
        PaddingBottom: =3.75
        PaddingLeft: =9.00
        Reset: =ResetNewProject
        Size: =17.99
        Width: =Parent.Width*.9
        X: =lblActivityDesc_2.X
        Y: =397.23
        ZIndex: =13

    lblTrade_8 As label:
        Height: =38
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =17.99
        Text: ="Trade"
        Width: =328
        X: =38
        Y: =499
        ZIndex: =14

    lblNumOfMen_5 As label:
        Height: =37
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =17.99
        Text: |-
            ="# of Men"
        Width: =326
        X: =403
        Y: =500
        ZIndex: =15

    lblGoal_5 As label:
        Height: =36
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =17.99
        Text: ="Goal"
        Width: =327
        X: =38
        Y: =769
        ZIndex: =16

    lblArea_6 As label:
        Height: =37
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =17.99
        Text: ="Area"
        Width: =293
        X: =404
        Y: =247
        ZIndex: =17

    txtArea_4 As text:
        Default: =LookUp('[dbo].[tblActivities]',ActivityID=First(cboxActivityNum_1.SelectedItems.ActivityID).ActivityID,Area)
        DisplayMode: =DisplayMode.View
        Height: =56
        HintText: |-
            ="Choose an activity #"
        PaddingBottom: =3.75
        PaddingLeft: =9.00
        Reset: =ResetNewProject
        Size: =17.99
        Width: =325
        X: =404
        Y: =284
        ZIndex: =18

    lblStartDate_5 As label:
        Height: =37
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =17.99
        Text: |-
            ="Start Date
            "
        Width: =346
        X: =38
        Y: =645
        ZIndex: =19

    DatePickerStartDate_1 As datepicker:
        DefaultDate: =LookUp('[dbo].[tblSchedule]',ScheduleID=SelectedScheduleID,StartDate)
        Height: =56.22
        InputTextPlaceholder: =
        Reset: =ResetEditSchedule
        Width: =325
        X: =38
        Y: =682
        ZIndex: =20

    lblDuration_5 As label:
        Height: =37
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =17.99
        Text: ="Duration (Days)"
        Width: =326
        X: =403
        Y: =645
        ZIndex: =21

    cboxActivityNum_1 As combobox:
        DefaultSelectedItems: =LookUp('[dbo].[tblActivities]',ActivityID = SelectedActivityID)
        DisplayFields: =["ActivityNum"]
        Height: =57
        IsSearchable: =false
        Items: ='[dbo].[tblActivities]'
        Reset: =ResetEditSchedule
        SearchFields: =["ActivityNum"]
        SearchItems: =[]
        SelectMultiple: =false
        Width: =275
        X: =38
        Y: =283
        ZIndex: =22

    txtNumOfMen_1 As text:
        Default: =LookUp('[dbo].[tblSchedule]',ScheduleID=SelectedScheduleID,NumOfMen)
        Format: =TextFormat.Number
        Height: =56
        HintText: ="Enter a number"
        PaddingBottom: =3.75
        PaddingLeft: =9.00
        Reset: =ResetEditSchedule
        Size: =17.99
        Width: =325
        X: =404
        Y: =537
        ZIndex: =23

    sliderDuration_1 As slider:
        Default: =LookUp('[dbo].[tblSchedule]',ScheduleID=SelectedScheduleID,Duration)
        Height: =56
        Max: =35
        Reset: =ResetEditSchedule
        X: =403
        Y: =682
        ZIndex: =24

    txtGoal_1 As text:
        Default: =LookUp('[dbo].[tblSchedule]',ScheduleID=SelectedScheduleID,Goal)
        Format: =TextFormat.Number
        Height: =56
        HintText: ="Enter a number"
        PaddingBottom: =3.75
        PaddingLeft: =9.00
        Reset: =ResetEditSchedule
        Size: =17.99
        Width: =329
        X: =37
        Y: =805
        ZIndex: =25

    cboxUnit_1 As combobox:
        DefaultSelectedItems: =LookUp('[dbo].[tblUnits]',UnitID=SelectedUnitID)
        DisplayFields: =["Unit"]
        Height: =56
        IsSearchable: =false
        Items: ='[dbo].[tblUnits]'
        Reset: =ResetEditSchedule
        SearchFields: =["Unit"]
        SearchItems: =[]
        SelectMultiple: =false
        Width: =275
        X: =404
        Y: =806
        ZIndex: =26

    lblUnit_1 As label:
        Height: =36
        PaddingBottom: =3.75
        PaddingLeft: =3.75
        Size: =17.99
        Text: ="Unit"
        Width: =327
        X: =404
        Y: =769
        ZIndex: =27

    Icon3_5 As icon.Add:
        Height: =56
        Icon: =Icon.Add
        OnSelect: |-
            =UpdateContext({ResetAddUnit:true});UpdateContext({ResetAddUnit:false});UpdateContext({AddUnit:true})
        Width: =56
        X: =679
        Y: =806
        ZIndex: =28

    grpAddActivityCheckPopup_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =56

        Rectangle3_2 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =939
            Visible: =EditScheduleCheckPopup
            Width: =768
            Y: =85
            ZIndex: =29

        lblActivityNum_6 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: |-
                ="Activity #"
            Visible: =EditScheduleCheckPopup
            Width: =225
            X: =20
            Y: =233
            ZIndex: =30

        lblArea_7 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: ="Area"
            Visible: =EditScheduleCheckPopup
            Width: =225
            X: =20
            Y: =275
            ZIndex: =31

        lvlActivityDesc_5 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: |-
                ="Activity Description
                "
            Visible: =EditScheduleCheckPopup
            Width: =225
            X: =20
            Y: =317
            ZIndex: =32

        lblTrade_6 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: ="Trade"
            Visible: =EditScheduleCheckPopup
            Width: =225
            X: =20
            Y: =359
            ZIndex: =33

        lblNewProject_10 As label:
            Align: =Align.Center
            Height: =100
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =26.99
            Text: ="Please ensure the following information is correct."
            Visible: =EditScheduleCheckPopup
            Width: =Parent.Width
            Y: =114
            ZIndex: =34

        btnConfirm_6 As button:
            Fill: =RGBA(168, 0, 0, 1)
            Height: =49.48
            OnSelect: |-
                =Patch(
                    '[dbo].[tblSchedule]',
                    First(Filter('[dbo].[tblSchedule]',ScheduleID=SelectedScheduleID)),
                    {
                        ProjectID: LookUp('[dbo].[tblSchedule]',ScheduleID=SelectedScheduleID,ProjectID),
                        ActivityID: cboxActivityNum_1.Selected.ActivityID,
                        StatusID: 4, //4=Not Started
                        NumOfMen: Value(txtNumOfMen_1.Text),
                        StartDate: DatePickerStartDate_1.SelectedDate,
                        Duration: sliderDuration_1.Value,
                        Goal: Value(txtGoal_1.Text),
                        UnitID: cboxUnit_1.Selected.UnitID,
                        Modified: Today(),
                        ModifiedBy: User().Email
                    }
                );
                UpdateContext({EditScheduleCheckPopup:false});
                UpdateContext({ResetEditSchedule:true});
                UpdateContext({ResetEditSchedule:false});
                Navigate(scrScheduleProjectActivities)
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =14.99
            Text: ="Confirm"
            Visible: =EditScheduleCheckPopup
            Width: =264
            X: =444
            Y: =905
            ZIndex: =35

        btnCancel_6 As button:
            Fill: =RGBA(168, 0, 0, 1)
            Height: =49.48
            OnSelect: |-
                =UpdateContext({EditScheduleCheckPopup:false})
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =14.99
            Text: ="Cancel"
            Visible: =EditScheduleCheckPopup
            Width: =264
            X: =68
            Y: =904
            ZIndex: =36

        lblNumOfMen_3 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: |-
                ="# of Men"
            Visible: =EditScheduleCheckPopup
            Width: =225
            X: =20
            Y: =401
            ZIndex: =37

        lblStartDate_3 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: ="Start Date"
            Visible: =EditScheduleCheckPopup
            Width: =225
            X: =20
            Y: =443
            ZIndex: =38

        lblEndDate_2 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: ="End Date"
            Visible: =EditScheduleCheckPopup
            Width: =225
            X: =20
            Y: =485
            ZIndex: =39

        lblDuration_3 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: ="Duration"
            Visible: =EditScheduleCheckPopup
            Width: =225
            X: =20
            Y: =527
            ZIndex: =40

        lblManHours_2 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: ="Man Hours"
            Visible: =EditScheduleCheckPopup
            Width: =225
            X: =20
            Y: =569
            ZIndex: =41

        lblGoal_3 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: ="Goal"
            Visible: =EditScheduleCheckPopup
            Width: =225
            X: =20
            Y: =611
            ZIndex: =42

        lblActivityNum_7 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =First(cboxActivityNum_1.SelectedItems.ActivityNum).ActivityNum
            Visible: =EditScheduleCheckPopup
            Width: =475
            X: =275
            Y: =233
            ZIndex: =43

        lblArea_8 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =LookUp('[dbo].[tblActivities]',ActivityID=First(cboxActivityNum_1.SelectedItems.ActivityID).ActivityID,Area)
            Visible: =EditScheduleCheckPopup
            Width: =475
            X: =275
            Y: =275
            ZIndex: =44

        lvlActivityDesc_6 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =LookUp('[dbo].[tblActivities]',ActivityID=First(cboxActivityNum_1.SelectedItems.ActivityID).ActivityID,ActivityDesc)
            Visible: =EditScheduleCheckPopup
            Width: =475
            X: =275
            Y: =317
            ZIndex: =45

        lblTrade_7 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =LookUp('[dbo].[tblTrades]',TradeID = cboxActivityNum_1.Selected.TradeID,Trade)
            Visible: =EditScheduleCheckPopup
            Width: =475
            X: =275
            Y: =359
            ZIndex: =46

        lblNumOfMen_4 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =txtNumOfMen_1.Text
            Visible: =EditScheduleCheckPopup
            Width: =475
            X: =275
            Y: =401
            ZIndex: =47

        lblStartDate_4 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =DatePickerStartDate_1.SelectedDate
            Visible: =EditScheduleCheckPopup
            Width: =475
            X: =275
            Y: =443
            ZIndex: =48

        lblEndDate_3 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =DateAdd(DatePickerStartDate_1.SelectedDate,sliderDuration_1.Value)
            Visible: =EditScheduleCheckPopup
            Width: =475
            X: =275
            Y: =485
            ZIndex: =49

        lblDuration_4 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =sliderDuration_1.Value
            Visible: =EditScheduleCheckPopup
            Width: =475
            X: =275
            Y: =527
            ZIndex: =50

        lblManHours_3 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =sliderDuration_1.Value*8
            Visible: =EditScheduleCheckPopup
            Width: =475
            X: =275
            Y: =569
            ZIndex: =51

        lblGoal_4 As label:
            Height: =37
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =18
            Text: =Concatenate(txtGoal_1.Text,Concatenate(" ",First(cboxUnit_1.SelectedItems.Unit).Unit))
            Visible: =EditScheduleCheckPopup
            Width: =475
            X: =275
            Y: =611
            ZIndex: =52

    grpAddUnit_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =67

        Rectangle4_3 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =940
            Visible: =AddUnit
            Width: =768
            Y: =84
            ZIndex: =53

        btnConfirm_7 As button:
            Fill: =RGBA(168, 0, 0, 1)
            Height: =49.48
            OnSelect: |-
                =Patch(
                    '[dbo].[tblUnits]',
                    Defaults('[dbo].[tblUnits]'),
                    {
                        Unit: txtNewUnit_1.Text
                    }
                );
                UpdateContext({AddUnit:false});
                UpdateContext({ResetAddUnit:true});
                UpdateContext({ResetAddUnit:false})
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =14.99
            Text: ="Add"
            Visible: =AddUnit
            Width: =264
            X: =464
            Y: =925
            ZIndex: =54

        btnCancel_7 As button:
            Fill: =RGBA(168, 0, 0, 1)
            Height: =49.48
            OnSelect: |-
                =UpdateContext({ResetAddUnit:true});UpdateContext({ResetAddUnit:false});UpdateContext({AddUnit:false})
            PaddingBottom: =3.75
            PaddingLeft: =3.75
            Size: =14.99
            Text: ="Cancel"
            Visible: =AddUnit
            Width: =264
            X: =88
            Y: =924
            ZIndex: =55

        lblNewUnit_1 As label:
            Size: =18
            Text: |-
                ="New Unit:"
            Visible: =AddUnit
            X: =57
            Y: =226
            ZIndex: =56

        txtNewUnit_1 As text:
            Default: =
            HintText: ="Enter a new Unit"
            Reset: =ResetAddUnit
            Size: =18
            Visible: =AddUnit
            Width: =450
            X: =207
            Y: =226
            ZIndex: =57

        lblExistingUnits_1 As label:
            Size: =18
            Text: |-
                ="Existing Units:"
            Visible: =AddUnit
            Width: =250
            X: =37
            Y: =322
            ZIndex: =58

        galExistingUnits_1 As gallery.galleryVertical:
            BorderThickness: =2
            Height: =500
            Items: ='[dbo].[tblUnits]'
            Layout: =Layout.Vertical
            TemplateSize: =80
            Visible: =AddUnit
            Width: =694
            X: =37
            Y: =362
            ZIndex: =59

            Label9_3 As label:
                OnSelect: =Select(Parent)
                Size: =18
                Text: =ThisItem.Unit
                X: =20
                Y: =20
                ZIndex: =1

            Rectangle5_3 As rectangle:
                Height: =1
                OnSelect: =Select(Parent)
                Width: =684
                Y: =79
                ZIndex: =2

